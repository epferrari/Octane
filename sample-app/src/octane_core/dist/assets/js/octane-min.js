/* octane -  - 2015-03-13*/!function(a,b,c){var d={isObject:function(a,b){return b?"object"==typeof a&&null!==a:"object"==typeof a&&null!==a&&!(a instanceof Array)},isArray:function(a){return"object"==typeof a&&a instanceof Array&&a.length>=0},isFalsey:function(a){var b="case_"+a,c={case_false:function(){return!0},case_0:function(){return!0},case_null:function(){return!0},case_undefined:function(){return!0},case_:function(){return!0}};return b=b.trim(),c[b]?c[b]():!1},isUndefined:function(a){return"undefined"==typeof a},isNull:function(a){return null===a},isBlank:function(a){var b="case_"+a,c={case_undefined:function(){return!0},case_null:function(){return!0},case_:function(){return!0}};return b=b.trim(),c[b]?c[b]():!1},is$:function(a){return a instanceof c},isEmail:function(a){return/^[-0-9a-zA-Z]+[-0-9a-zA-Z.+_]+@(?:[A-Za-z0-9-]+\.)+[a-zA-Z]{2,4}$/.test(a)},createEvent:function(a){var b;try{b=new Event(a)}catch(c){b=document.createEvent("event"),b.initEvent(a,!0,!1)}return b},customEvent:function(a,c){var d;if(b.CustomEvent)try{c=c||{bubbles:!1,cancelable:!1,detail:{}},d=new CustomEvent(a,c)}catch(e){d=document.createEvent("CustomEvent"),d.initCustomEvent(a,c.bubbles||!1,c.cancelable||!1,c.detail||{})}else d=document.createEvent("CustomEvent"),d.initCustomEvent(a,c.bubbles||!1,c.cancelable||!1,c.detail||{});return d},Switch:function(a){function b(a,b,c){return c?void("undefined"==d.typeOf(f[a])&&(f[a]=[b])):(f[a]=_.isArray(f[a])?f[a]:[],_.isFunction(b)&&f[a].push(b),e)}function c(a,b){function c(a,b){var c=a.length;if(1==c)return _.isFunction(a[0])&&a[0].apply(null,b);for(var e=0;c>e;e++)d(a[e],b)}function d(a,b){setTimeout(function(){_.isFunction(a)&&a.apply(null,b)},0)}f["default"]||(f["default"]=[function(){return!1}]);return b=_.isArray(b)?b:[b],f[a]?c(f[a],b):f["default"][0].apply(null,b)}var e=this,f={};if(_.isObject(a))for(var g in a)({}).hasOwnProperty.call(a,g)&&b(g,a[g]);this.addCase=function(a,c){return b(a,c)},this.run=function(a,b){return c(a,b)},this.getCases=function(){return f}},typeOf:function(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},urlObject:function(){var a,c,e=document.createElement("a"),f={};e.href=b.location,a=e.search.replace(/^\?/,"").split("&");for(var g=0,h=a.length;h>g;g++)if(c=a[g].split("="),!d.isBlank(c)){var i=c[0],j=c[1];f[i]=j}return{protocol:e.protocol,host:e.host,hostname:e.hostname,port:e.port,pathname:e.pathname,searchString:e.search,searchObject:f,hash:e.hash}},titleize:function(a){return"string"==d.typeOf(a)?a.replace(/\-+|[_]+/," ").replace(/^.|\s+?[a-z]/g,function(a){return a.toUpperCase()}):void 0},camelize:function(a){return"string"==d.typeOf(a)?a.replace(/\W+?[a-z]|\_+?[a-z]/g,function(a){return a.toUpperCase()}).replace(/\W+|\_+/g,""):void 0},dashify:function(a){return"string"==d.typeOf(a)?a.replace(/\s+|[_]+/g,"-").replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()}).replace(/-{2}/g,"-"):void 0},inArray:function(a,b){return-1!==a.indexOf(b)}};!String.prototype.__titleize&&Object.defineProperty(String.prototype,"__titleize",{value:function(){return this.replace(/\-+|[_]+/," ").replace(/^.|\s+?[a-z]/g,function(a){return a.toUpperCase()})},configurable:!1,writable:!1,enumerable:!1}),!String.prototype.__camelize&&Object.defineProperty(String.prototype,"__camelize",{value:function(){return this.replace(/\W+?[a-z]|\_+?[a-z]/g,function(a){return a.toUpperCase()}).replace(/\W+|\_+/g,"")},configurable:!1,writable:!1,enumerable:!1}),!String.prototype.__dashify&&Object.defineProperty(String.prototype,"__dashify",{value:function(){return this.replace(/\s+|[_]+/g,"-").replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()}).replace(/-{2}/g,"-")},configurable:!1,writable:!1,enumerable:!1}),!Function.prototype.__construct&&Object.defineProperty(Function.prototype,"__construct",{value:function(a){var b=this.prototype,c=Object.create(b);return this.apply(c,a),c},configurable:!1,writable:!1,enumerable:!1}),!Array.prototype.__contains&&Object.defineProperty(Array.prototype,"__contains",{value:function(a){return-1!==this.indexOf(a)},configurable:!1,writable:!1,enumerable:!1}),!Array.prototype.__isEmpty&&Object.defineProperty(Array.prototype,"__isEmpty",{value:function(){return 0===this.length},configurable:!1,writable:!1,enumerable:!1}),!Object.prototype.__isEmpty&&Object.defineProperty(Object.prototype,"__isEmpty",{value:function(){var a;for(a in this)if({}.hasOwnProperty.call(this,a))return!1;return!0},configurable:!1,writable:!1,enumerable:!1}),Object.defineProperty(Array.prototype,"__forEach",{value:function(a){var b=this.length,c=0;for(c;b>c;c++)a(this[c],c)},configurable:!1,writable:!1,enumerable:!1}),Object.defineProperty(Array.prototype,"__map",{value:function(a){for(var b=this.length,c=[],d=0;b>d;d++)c[d]=a(this[d],d);return c},configurable:!1,writable:!1,enumerable:!1}),Object.defineProperty(Array.prototype,"__concatAll",{value:function(){var a=[];return this.forEach(function(b){b.forEach(function(b){a.push(b)})}),a},configurable:!1,writable:!1,enumerable:!1}),b[a]=d}("__",window,jQuery),function(a,b,c){"use strict";function d(){}function e(a){if(!b.isFunction(a))throw"OctanePromise expects function as first argument";state="pending",this.result=null,this.error=null,this.engrave({isResolved:function(){return"resolved"==state},isRejected:function(){return"rejected"==state},isPending:function(){return"pending"==state},resolveCallbacks:[],rejectCallbacks:[]});var c=function(a){state="resolved";var b=this.resolveCallbacks,c=b.length,d=0;for(this.engrave({result:a});c>d;d++)setTimeout(function(){b[d].call&&b[d].call(null,a)},0)},d=function(a){state="rejected",this.engrave({error:a});for(var b=this.rejectCallbacks,c=b.length,d=0;c>d;d++)setTimeout(function(){b[d].call&&b[d].call(null,a)},0)};a.apply(a,[c.bind(this),d.bind(this)])}function f(a){this.message=a||"An Octane error occurred.",this.stack=Error().stack}function g(a){a=b.isObject(a)?a:{};for(var c=Object.keys(a),d=c.length,e=[];d--;)e.push(encodeURIComponent(c[d])+"="+encodeURIComponent(a[c[d]]));return e.join("&")}function h(a,d,e,f){return new Promise(function(h,i){var j,k,l,m,n=g(e),o={"Content-Type":"application/x-www-form-urlencoded"};b.extend(o,f),k=Object.keys(o);try{j=new(window.XMLHttpRequest||window.ActiveXObject)("MSXML2.XMLHTTP.3.0")}catch(p){q.error("Could not create XMLHttpRequest object")}j.onreadystatechange=function(){4===j.readyState&&new c.Switch({200:function(a){var b;try{b=JSON.parse(j.responseText)}catch(c){b=j.responseText}a(b)},404:function(a,b){b(q.error("The server responded with 400 not found"))},500:function(a,b){b(q.error("An internal server error occurred"))}}).run(j.status,[h,i])},j.open(d,a,!0);for(var r=0,s=k.length;s>r;r++)l=k[r],m=o[l],j.setRequestHeader(l,m);j.send(n)})}function i(a,c){this.url=a,this.headers=b.isObject(c)?c:{}}function j(a,c){var d=this;return new Promise(function(e,f){if(b.isObject(c)){var g=b.isObject(c)?c:{};d.name=a,d.checkout=function(){return g},d.contrib=function(a,b){g[a]||(g[a]=b)},e(g)}else f("invalid library data, not an object")})}function k(){this.engrave({scope:{}}),this.parse(),this.refreshAll()}function l(a,b){var c=!1,d=null;this.className=this.className||"OctaneModel",this.engrave({guid:"model_"+q.GUID(),state:{},become:function(a){return p.models[a]&&p.models[a].detach(),p.models[a]=this,c=!0,d=a,q.fire("statechange:"+a),this},detach:function(){if(c){var a=d;p.models[a]=null,c=!1,d=null,q.fire("statechange:"+a)}return this},isRegistered:function(){return c},registeredTo:function(){return d},bind:function(a){return this.become.apply(this,[a])},unbind:function(){return this.detatch.apply(this)}}),this.set(this.defaults),this.set(a),this.initialize&&this.initialize.apply(this,arguments),b&&this.become(b)}function m(a,c){b.isString(a)&&(this.name=a),b.isPlainObject(c)&&b.extend(this,c),this.initialize&&this.initialize.apply(this,arguments),this.name&&(p.controllers[this.name]=this)}function n(a,b){this.initialized=!1,this.name=a,this.imports={},this.controllers={},this.dependencies=b,this.dependenciesLoaded=[]}function o(a){var b=a.getAttribute("name");this.id=b||a.name||a._guid||(a._guid=q.GUID()),this.markup=a.innerHTML,this.content="",this.parent=a.parentElement}if(!b)throw new Error("Cannot run Octane. A Lodash (_) compatible utility library is not present. ");if(!c)throw new Error("Cannot run Octane. The doubleUnder (__) utility library not present. ");if(window.octane)throw new Error('Variable "octane" was already defined in global scope. Will be overwritten.');d.prototype={extend:function(a){return b.extend(this,a)}},Object.defineProperty(d.prototype,"Base",{value:function(){return new d},writable:!1,configurable:!1}),Object.defineProperty(d.prototype,"augment",{value:function(a,c){c=b.isBoolean(c)?c:!0;var d,e,f;if(b.isObject(a))for(d=Object.keys(a),f=d.length;f--;)e=d[f],c?this[e]=a[e]:this[e]||(this[e]=a[e]);return this},writable:!1,configuarable:!1}),Object.defineProperty(d.prototype,"engrave",{value:function(a,c,d){switch(b.isBoolean(arguments[0])?(a=arguments[0],c=arguments[1],d=arguments[2]):(c=arguments[0],d=arguments[1],a=!1),!0){case b.isObject(c):for(var e,f=Object.keys(c),g=0,h=f.length;h>g;g++)e=f[g],Object.defineProperty(this,e,{value:c[e],configurable:!1,writable:a,enumerable:!0});break;case b.isString(c):Object.defineProperty(this,c,{value:d,configurable:!1,writable:a,enumerable:!0})}return this},writable:!1,configuarable:!1}),Object.defineProperty(d.prototype,"defineGetter",{value:function(a,b){Object.defineProperty(this,a,{get:b,configurable:!1})},writable:!1,configurable:!1}),Object.defineProperty(d.prototype,"defineSetter",{value:function(a,b){Object.defineProperty(this,a,{set:b,configurable:!1})},writable:!1,configurable:!1});var p=new d,q=new d;q.initialized=!1,q.engrave({GUID:function(){var a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1).toUpperCase()};return a()+"-"+a()+"-"+a()+a()}});var r={ordinances:{},designate:function(a,b){b._compilerId||(b._compilerId=q.GUID());var c=this.ordinances;(c[a]||(c[a]=[])).push(b)},applyOrdinance:function(a,c){c||(c=a,a=document);var d=this.ordinances[c];return new Promise(function(e){b.each(a.querySelectorAll(c),function(a){b.each(d,function(d){var e,f=d._compilerId;if(a._compiled||(a._compiled={}),!a._compiled[f]){var g=c.match(/\[(.*)\]/);b.isArray(g)&&(g=g[1]),e=a.getAttribute(g);try{d(a,e),a._compiled[f]=!0}catch(h){q.log(h)}}})}),e()})},run:function(a){a||(a=document);var b=this,c=Object.keys(this.ordinances).map(function(c){return b.applyOrdinance(a,c)});return Promise.all(c)}};q.engrave({compiler:function(a,b){return r.designate.apply(r,[a,b]),q},designate:function(a,b){return r.designate.apply(r,[a,b]),q},recompile:r.run.bind(r)}),e.resolve=function(a){return new e(function(b){b(a)})},e.reject=function(a){return new e(function(b,c){c(a)})},e.prototype=new d,e.prototype.constructor=e,e.prototype.engrave({then:function(a,c){return b.isFunction(a)||(a=function(){}),b.isFunction(c)||(c=!1),this.resolveCallbacks.push(a),c&&this.rejectCallbacks.push(c),this.isResolved()?a(this.result):this.isRejected()?(c&&c(this.error),this):void 0}}),q.engrave({promisify:function(a){var b=Array.prototype.slice.call(arguments,1);return new Promise(function(c,d){a.apply(a,b).then(c,d)})}}),p.logfile=[],p.log=function(a){p.logfile.push(a)},f.prototype=Object.create(Error.prototype),f.prototype.constructor=f,f.prototype.name="OctaneError",q.engrave({log:function(a){q.hasModule("Debug")&&p.log(a)},error:function(a){throw new f(a)}}),i.prototype=new d,i.prototype.engrave({get:function(){return h(this.url,"GET",null,this.headers)},post:function(a){return h(this.url,"POST",a,this.headers)},put:function(a){return h(this.url,"PUT",a,this.headers)},"delete":function(){return h(this.url,"DELETE",null,this.headers)}}),p.loadedCache=[],q.engrave({http:function(a,b){return new i(a,b)},getLibrary:function(a){return new Promise(function(b,c){var d,e,f=a.replace(/[.\/:]/g,"_"),g=document.querySelectorAll("script#"+f);0!==g.length?q.hasLibrary(f).then(b,c):(q.handle("script:loaded:"+f,function(){e=p.loadedCache.pop(),q.addLibrary(f,e).then(b,c)}),q.handle("script:failed:"+f,function(){c("Script failed to load from "+a)}),d=document.createElement("script"),d.id=f,d.src=a,d.onload=function(){q.fire("script:loaded:"+f)},d.onerror=function(){q.fire("script:failed:"+f)},document.body.appendChild(d))})},jsonp:function(a){if(b.isString(a))try{a=JSON.parse(a)}catch(c){q.log("failed to parse JSON from Octane.jsonp() "+c.message)}b.isObject(a)&&p.loadedCache.push(a)}}),p.eventHandlerMap={},p.eventHandler=function(a){var b=a.target||a.srcElement,d=b._guid,e=p.eventHandlerMap[d]?p.eventHandlerMap[d][a.type]:[],f=new c.Switch({"function":function(a,b,c){try{b(c,a)}catch(d){}},object:function(a,b,c){try{b.handleEvent(c,a)}catch(d){}}});try{e.__forEach(function(d){f.run(c.typeOf(d),[b,d,a])})}catch(g){}},p.addHandler=function(a,b,c){var d=b._guid||(b._guid=q.GUID()),e=this.eventHandlerMap;try{e[d][a].push(c)}catch(f){try{e[d][a]=[],e[d][a].push(c)}catch(f){e[d]={},e[d][a]=[],e[d][a].push(c)}}},q.engrave({handle:function(a){var b,c,d=a?a.split(" "):[],e=d.length;if(3==arguments.length)b=arguments[2],c=arguments[1];else{if(2!=arguments.length)return;b=arguments[1],c=window}for(;e--;)p.addHandler(d[e],c,b),window.addEventListener(d[e],p.eventHandler,!1);return this},drop:function(){{var a,d,e;new c.Switch({3:function(c){e=c[2],d=c[1],a=c[0];try{b.pull(p.eventHandlerMap[d._guid][a],e)}catch(f){}},2:function(b){d=b[1],a=b[0];try{delete p.eventHandlerMap[d._guid][a]}catch(c){}},1:function(){d=arguments[0];try{delete p.eventHandlerMap[d._guid]}catch(a){}}}).run(arguments.length,[arguments])}return this},fire:function(a,d){if(b.isString(a)){var e=d?c.customEvent(a,d):c.createEvent(a);window.dispatchEvent(e)}},trip:function(a){var b=Math.random(),d=c.customEvent("input",{bubbles:!0,detail:b});a.dispatchEvent&&a.dispatchEvent(d)}}),p.libraries={},q.engrave({library:function(a,c){return b.isObject(c)?p.libraries[a]=new j(a,c):Promise.reject("could not create library "+a+". Data was not an object")},getLib:function(a){return q.hasLibrary(a).then(function(a){return a})},hasLibrary:function(a){var b=p.libraries[a];return b instanceof j?b:Promise.reject("Error: Library "+a+" does not exist")}}),k.prototype=new d,k.prototype.engrave({parse:function(a){a||(a=document);this.bindScope=a.querySelectorAll("[o-bind],[o-update]");for(var b=this.bindScope.length;b--;)this.watch(this.bindScope[b])},watch:function(a){this.scope;a._watched||(a._watched=!0,a._guid||(a._guid=q.GUID()),this._watchBinds(a),this._watchUpdates(a))},_watchBinds:function(a){var c,d,e=this,f=a.getAttribute("o-bind"),g=this.scope;f&&(a._bind=f,q.handle("input click select",a,e.uptake).handle("statechange:"+f,e.refresh),"file"==a.type&&q.handle("change",a,e.uptake),c=f.split("."),d=c.length,c.reduce(function(c,d,h){var i;return i=0===h?d:c+"."+d,b.isArray(g[i])||(g[i]=[]),g[i].push({key:f,elem:a,attr:"value"}),q.handle("statechange:"+i,e.refresh.bind(e)),i},""))},_watchUpdates:function(a){var c,d=a.getAttribute("o-update"),e=this,f=this.scope;if(d){if(a._update=c,c={},d.length>0&&0!==d.indexOf("{"))c[d]="html";else try{c=b.invert(JSON.parse(d))}catch(g){q.log(g.message+" in ViewModel.parse(), element: "+a+" Error: "+g)}b.forOwn(c,function(c,d){{var g=d.split(".");g.length}g.reduce(function(g,h,i){var j;return j=0===i?h:g+"."+h,b.isArray(f[j])||(f[j]=[]),f[j].push({key:d,elem:a,attr:c}),q.handle("statechange:"+j,e.refresh.bind(e)),j},"")})}},refresh:function(a){if("statechange"==a.type.split(":")[0]){var c=this._update.bind(this),d=this.scope,e=a.type.replace("statechange:","");b.isArray(d[e])&&b.each(d[e],c)}},_getUpdateTargets:function(a){var c=Object.keys(a),d=this;return c.__map(function(c){var e,f=a[c];if(b.isPlainObject(f)){if(e=d._getUpdateTargets(f)[0])return e}else if(b.isArray(f))return f})},_update:function(a){var d,e,f=a.key,g=a.elem,h=a.attr,i=q.get(f),j=g.getAttribute("o-filter");g.parentNode||b.pull(this.scope[f],a),(c.isNull(i)||c.isUndefined(i))&&(i=""),j&&(j=j.split(",")),-1!==h.indexOf(".")?(d=h.split(".")[1],g.style[d]=i):e=new c.Switch({html:function(a){g.innerHTML=j?q.applyFilter(j[0],a,j[1]):a},text:function(a){g.textContent=j?q.applyFilter(j[0],a,j[1]):a},value:function(a){g.value=a},src:function(a){g.src=a},"default":function(a,b){g.setAttribute(b,a)}}).run(h,[i,h])},refreshAll:function(){for(var a=Object.keys(p.models),b=a.length;b--;)q.fire("statechange:"+a[b])},uptake:function(a,b){{var c=b._bind;c?l._parseName(c):null,c?l._parseKey(c):null}return"file"===b.type?void q.set(c,b.files):("TEXT-AREA"==b.tagName&&(b.value=b.innerHTML),void(b.value!=q.get(c)&&q.set(c,b.value)))},rescope:function(){this.parse(),this.refreshAll()},bind:function(a,c){var d=!1,e=null;return a.__legacy__={set:a.set,get:a.get,clear:a.clear},b.extend(a,{become:function(a){return this.detach(),p.models[a]&&p.models[a].detach(),p.models[a]=this,d=!0,e=a,q.fire("statechange:"+a),this},detach:function(){if(d){var a=e;p.models[a]=null,d=!1,e=null,q.fire("statechange:"+a)}return this},isRegistered:function(){return d},registeredTo:function(){return e},set:function(){l.set.apply(this,arguments)},get:function(){return this.state=this.attributes,l.prototype._get.apply(this,arguments)},clear:function(a){var c={};for(var d in this.attributes)c[d]=void 0;return this.set(c,b.extend({},a,{unset:!0}))},original:function(){var a=this.constructor,c=new a;c.set(this.attributes),b.extend(c,this,this.__legacy__);var d=["__legacy__","become","detach","isRegistered","registeredTo","original"];return b.each(d,function(a){delete c[a]}),c}}),c&&a.become(c),a},unbind:function(a){var b=p.models[a];return b?(b.__legacy__&&(b.set=b.__legacy__.set,b.get=b.__legacy__.get,b.clear=b.__legacy__.clear),b.isRegistered()&&b.detach(),delete b.attach,delete b.detach,delete b.isRegistered,delete b.registeredTo,delete b.__legacy__,b):void 0},get:function(a){return p.models[a]}}),p.models={},q.engrave.call(l,{create:function(a,b){return new this(a,b)},set:function(a,d,e){var f,f,g,h=this;return"object"==c.typeOf(a)?(f=a,e=d):(f={})[a]=d,b.extend(g={},this.attributes),this.isRegistered()&&b.forOwn(f,function(a,b){p.hooks[h.registeredTo()+"."+b]&&l.prototype._applyHooks.apply(h,[b,f])}),b.forOwn(f,function(a,c){var d=c.split("."),f=d[0],i=d.length;d.reduce(function(c,d,e){return c[d]=e==i-1?a:b.isObject(c[d])?c[d]:{}},g),g[f]!=h.attributes[f]&&(h.__legacy__.set.apply(h,[f,g[f],e]),h.isRegistered()&&octane.fire("statechange:"+h.registeredTo()+"."+c))}),this.attributes},_parseName:function(a){try{return a.split(".")[0]}catch(b){return q.error("could not parse model name from "+a+": "+b.message),!1}},_parseKey:function(a){try{return a.split(".").slice(1).join(".")}catch(b){return q.error("could not parse model key from "+a+": "+b.message),!1}}}),l.prototype=new d,l.prototype.initialize=function(){},l.prototype.defaults={},l.prototype.constructor=l,l.prototype.engrave({_set:function(){var a,c,d,e,f,g;if(b.isString(arguments[0]))a={},a[arguments[0]]=arguments[1];else{if(!b.isObject(arguments[0]))return{};a=arguments[0]}if(c=Object.keys(a),d=c.length,this.isRegistered())for(;d--;)p.hooks[this.registeredTo()+"."+c[d]]&&this._applyHooks(c[d],a);for(c=Object.keys(a),e=c.length;e--;)f=c[e],g=a[f],this._setState(f,g);return this.isRegistered()&&(q.fire(this.registeredTo()+":statechange"),q.fire("statechange:"+this.registeredTo())),a},_setState:function(a,c){var d,e=this.state,f=a.split("."),g=f.length;try{f.reduce(function(a,d,e){return a[d]=e==g-1?c:b.isPlainObject(a[d])?a[d]:{}},e),d=!0}catch(h){d=!1,q.log('Unable to set model data "'+a+'". Error: '+h)}d&&this.isRegistered()&&q.fire("statechange:"+this.registeredTo()+"."+a)},_applyHooks:function(a,c){if(this.isRegistered()){var d=this.registeredTo(),e=p.hooks[d+"."+a];b.isArray(e)&&b.each(e,function(a){b.extend(c,a(c))})}},_unset:function(a,d,e){var f=this;a&&(b.isArray(a)||(a=a.split(",")),d&&"number"==c.typeOf(d)?e?b.each(a,function(a,b){setTimeout(function(){f.set(a,void 0)},d*(b+1))}):setTimeout(function(){b.each(a,function(a){f.set(a,void 0)})},d):b.each(a,function(a){f.set(a,void 0)}))},_destroy:function(){for(var a=Object.keys(this.state),b=a.length;b--;)delete this.state[a[b]];this.isRegistered()&&this.detach()},_get:function(a){var c,d=this;if(a&&b.isString(a)){{var e=a.split(".");e.length}try{c=e.reduce(function(a,b){return a[b]},d.state)}catch(f){c="",q.log('Unable to get model data "'+a+'". Error: '+f.message)}return c}return this.state},_clear:function(){for(var a,b=Object.keys(this.state),c=b.length;c--;)a=b[c],delete this.state[a],this.isRegistered()&&q.fire("statechange:"+this.registeredTo()+"."+a);return this.isRegistered()&&(q.fire(this.registeredTo()+":statechange"),q.fire("statechange:"+this.registeredTo())),this},reset:function(a){this.clear().set(a||this.defaults)}}),l.prototype.augment({get:function(){return this._get.apply(this,arguments)},set:function(){return this._set.apply(this,arguments)},unset:function(){return this._unset.apply(this,arguments)},clear:function(){return this._clear()},destroy:function(){this._destroy()}}),q.engrave({Model:l,model:function(a){var b;return b=p.models[a]?p.models[a]:(new l).become(a)},get:function(a){var b=l._parseName(a),c=l._parseKey(a),d=p.models[b];return d&&c?d.get(c):d?d.get():void 0},set:function(){function a(a){var b=l._parseName(a),c=l._parseKey(a),e=d[a],f=p.models[b];f&&f.set(c,e)}var b,d,e,f,g,h=arguments[0],i=arguments[1];for(b=new c.Switch({string:function(a,b){d={},d[a]=b},object:function(a){d=a},"default":function(){d={}}}).run(c.typeOf(h),[h,i]),e=Object.keys(d),g=e.length,f=0;g>f;f++)a(e[f])},unset:function(a,d,e){if(a){b.isArray(a)||(a=a.split(","));var f=function(a){a=a.trim();var b=l._parseName(a),c=l._parseKey(a),d=p.models[b];d&&d.unset(c)};d&&"number"==c.typeOf(d)?e?b.each(a,function(a,b){setTimeout(function(){f(a)},d*(b+1))}):setTimeout(function(){b.each(a,f)},d):b.each(a,f)}}}),p.controllers={},m.prototype=new d,m.prototype.constructor=m,m.prototype.initialize=function(){},m.prototype.defaults={},m.prototype.destroy=function(){this._destroy.apply(this)},m.prototype.engrave({_destroy:function(){delete p.controllers[this.name]}}),q.engrave({controller:function(a,b){return a?p.controllers[a]?p.controllers[a]:new m(a,b):new m(q.GUID())},Controller:m});var s=function(){var a,d,e,f,g,h,i;return"string"==c.typeOf(arguments[0])?(a=arguments[0],d=arguments[1]||{},e=arguments[2]||{}):(d=arguments[0]||{},e=arguments[1]||{}),f=this,g=f.prototype.defaults||{},h=d.constructor!=Object&&b.isFunction(d.constructor)?d.constructor:function(){return f.apply(this,arguments)},b.extend(h,f,e),i=function(){this.constructor=h},i.prototype=f.prototype,h.prototype=new i,h.prototype.defaults={},b.extend(h.prototype,d),b.extend(h.prototype.defaults,g,d.defaults),h.__legacy__=f.prototype,h},t=function(){this.initialize.apply(this,arguments)};t.prototype=new d,t.prototype.initialize=function(){},t.prototype.defaults={},q.engrave.apply(t,[{engrave:q.engrave}]),q.engrave({Factory:t}),l.extend=m.extend=t.extend=s,p.filters={},q.engrave({filter:function(a,b){p.filters[a]=b},applyFilter:function(a,b,c){var d,e=b;if(d=p.filters[a])try{e=d.apply(null,[b,c])}catch(f){q.log(f)}return e}}),q.engrave({task:function(a,b){var c={},d=a.split(".");return d.reduce(function(d,e,f){var g;return g=0===f?e:d+"."+e,q.handle("statechange:"+g,function(){var d=q.get(a);d!=c[a]&&(c[a]=d,b(d,a))}),g},""),this}}),p.hooks={},q.engrave({hook:function(a,b){try{p.hooks[a].push(b)}catch(c){p.hooks[a]=[],p.hooks[a].push(b)}return this}}),p.modules={},p.moduleConfigs={},p.moduleExports={};var u=p.bootlog=[];n.prototype=new d,n.prototype.initialize=function(){},n.prototype.constructor=n,n.prototype.engrave({"import":function(a){return p.moduleExports[a]},"export":function(a){b.isObject(p.moduleExports[this.name])||(p.moduleExports[this.name]={});try{b.extend(p.moduleExports[this.name],a)}catch(c){q.log("Could not create exports, "+this.name+" module. "+c.message)}},_getImports:function(){b.transform(this.dependenciesLoaded,function(a,b){a[b]=p.moduleExports[b]},this.imports)},_initialize:function(){var a=this,b=p.moduleConfigs[this.name]||{},c=["       "+this.name+": initializing...","       "+this.name+": successfully initialized!","       "+this.name+": already initialized, continuing...","FAILED "+this.name+": failed to initialize!"];return this.initialized?Promise.resolve(this):n.checkDependencies(this).then(function(){return u.push(c[1]),a._getImports(a.name),a.initialize(b),q.App.set({loadingProgress:Math.ceil(100/Object.keys(p.modules).length)}),q.fire("loaded:module",{detail:{moduleID:a.name}}),a.initialized=!0,Promise.resolve(a)}).catch(function(b){return u.push(b),a.initialized=!1,Promise.reject(c[3])})},checkDependency:function(a){a=a?a.trim():"";var c=this,d=p.modules[a],e=["       "+this.name+": no dependencies, preparing to initialize...","FAILED "+this.name+': Could not load module, missing module dependency "'+a+'"',"       "+this.name+': dependency "'+a+'" loaded and initialized, continuing...',"       "+this.name+': dependency "'+a+'" not yet loaded, loading now...'];switch(!0){case!a||0===a.length:return u.push(e[0]),Promise.resolve();case!(d&&d instanceof n):return u.push(e[1]),Promise.reject(e[1]);case d&&d.initialized:return u.push(e[2]),this.dependenciesLoaded.push(a),b.pull(this.dependencies,a),Promise.resolve();case!d.initialized:return u.push(e[3]),d._initialize().then(function(){c.dependenciesLoaded.push(a),b.pull(c.dependencies,a)}).catch(function(a){u.push(a),Promise.reject(a)})}},controller:function(a,b){return(b||(b={})).moduleConfig=p.moduleConfigs[this.name]||{},this.controllers[a]=octane.controller(a,b),this}}),b.extend(n,{checkDependencies:function(a){var b=a.dependencies||[],c=b.length,d=[],e=["       "+a.name+": checking dependencies...","       "+a.name+": no dependencies, preparing to initialize..."];if(u.push(e[0]),0===c)return u.push(e[1]),Promise.resolve();for(;c--;)d.push(a.checkDependency(b[c]));return Promise.all(d)},load:function(a){var c=n.config,d=a.name,e=p.moduleConfigs;return e[d]||(e[d]={}),b.extend(e[d],c[d]),a.initialized?void 0:(u.push("       "+d+": not loaded, loading..."),a._initialize())}}),q.engrave({module:function(a,b){return p.modules[a]=new n(a,b)},hasModule:function(a){return p.modules[a]&&p.modules[a].initialized},moduleConfig:function(a,c){b.isPlainObject(c)&&(p.moduleConfigs[a]=c)}}),q.defineGetter("loadingContainer",function(){return document.getElementsByTagName("o-loading-container")[0]||document.createElement("o-loading-container")}),q.defineGetter("bgContainer",function(){return document.getElementsByTagName("o-background")[0]||document.createElement("o-background")}),q.defineGetter("appContainer",function(){return document.getElementsByTagName("o-app-container")[0]||document.createElement("o-app-container")}),q.defineGetter("viewContainer",function(){return document.getElementsByTagName("o-view-container")[0]||document.createElement("o-view-container")}),q.defineGetter("modalContainer",function(){return document.getElementsByTagName("o-modal-container")[0]||document.createElement("o-modal-container")}),q.defineGetter("listViewElements",function(){return document.getElementsByTagName("o-view")}),q.defineGetter("listModalElements",function(){return document.getElementsByTagName("o-modal")}),p.templates={},b.extend(o,{get:function(a){return p.templates[a]},create:function(a){return new o(a)},fromString:function(a,b){var c=document.createElement("div");return c.name=a,c.innerHTML=b,new o(c)},parse:function(a,c){b.isString(a)||(a=""),b.isObject(c)||(c={});var d,e=/\{\{([^{^}]+)\}\}/g,f=a.match(e);if(b.isArray(f))for(d=f.length;d--;)a=this._replace(a,f[d],c);return a},_replace:function(a,c,d){var e=c.replace(/[{}]+/g,""),f=e.split(/\s/),g=f[0],h=f[1],i=f[2],j=new RegExp("(\\{\\{"+e+"\\}\\})","g"),k=g.split("."),l=k.length,m=k.reduce(function(a,c,d){return d==l-1&&b.isObject(a)?a[c]:b.isObject(a)?a[c]:null},d)||"";return h&&(i&&(i=i.replace("@param:","")),h=h.replace("@filter:",""),m=q.applyFilter(h,m,i)),a.replace(j,m)},compile:function(a){a||(a=document);for(var b=a.querySelectorAll('script[type="text/octane-template"],o-template'),c=b.length;c--;)this._cache(b[c])},_cache:function(a){if(a){this.compile(a);var b=this.create(a);b.save(),a.parentElement.removeChild(a)}},_render:function(a,b,d){var e,f,g=document.createElement("div"),h=b.firstChild,i=a.content;g.innerHTML=i,g.normalize(),e=g.childNodes,f=new c.Switch({prepend:function(a,b){for(var c,d=0,e=b.length;e>d;d++)c=b[d],c&&c.nodeType==(Node.ELEMENT_NODE||Node.TEXT_NODE)&&a.insertBefore(c,h)},append:function(a,b){for(var c,d=0,e=b.length;e>d;d++)c=b[d],c&&c.nodeType==(Node.ELEMENT_NODE||Node.TEXT_NODE)&&a.appendChild(b[d])},replace:function(a,b,c){a.innerHTML=c},"default":function(a,b,c){a.innerHTML=c}}),f.run(d,[b,e,i]),q.recompile(b)},prototype:new d}),o.prototype.engrave({set:function(a){return this.content=o.parse(this.markup,a),this},replace:function(a){o._render(this,a,"replace")},renderTo:function(a){o._render(this,a,"elem")},prependTo:function(a){o._render(this,a,"prepend")},appendTo:function(a){o._render(this,a,"append")},save:function(){p.templates[this.id]?q.log("Could not create template "+this.id+". Already exists"):p.templates[this.id]=this},append:function(){var a=this.parent;a instanceof HTMLElement&&this.appendTo(a)},prepend:function(){var a=this.parent;a instanceof HTMLElement&&this.prependTo(a)},render:function(){var a=this.parent;a instanceof HTMLElement&&this.renderTo(a)}}),q.engrave({Template:o}),q.designate("[o-controller]",function(a,b){var c,d,e,f,g,h,i;try{c=JSON.parse(b),d=b[0],e=b[1],f=b[2],i=b[3]}catch(j){d="click",g=b.split(" "),h=g[0],h=h.split("."),e=h[0],f=h[1],i=g[1]?g[1].replace(/[@]\w*[:]/,""):null}a.addEventListener(d,function(){var b=p.controllers[e];try{b[f].apply(b,[a,i])}catch(c){q.log(c)}})}),q.designate("[o-sync]",function(a,b){var c=new q.Template(a);c.save(),a.innerHTML="",q.handle("statechange:"+b,function(){var c=q.ViewModel.get(b).get();q.Template.get(a._guid).set(c).renderTo(a)})}),q.designate("[o-src]",function(a,b){var c=/\{\{([^{^}]+)\}\}/g;c.test(b)||(a.src=b)}),q.designate("[o-bg-img]",function(a,b){var c=/\{\{([^{^}]+)\}\}/g;c.test(b)||(a.style.backgroundImage="url("+b+")")});var v=l.extend({hint:function(){var a,c,d;if(b.isString(arguments[0]))a={},a[arguments[0]]=arguments[1],d=arguments[2];else{if(!b.isObject(arguments[0]))return{};a=arguments[0],d=arguments[1]}d||(d=5e3),c=Object.keys(a),this._set(a),this._unset(c,d)}});p.context="web",Object.defineProperty(q,"context",{get:function(){return p.context},set:function(a){var b=["html4","html5","web","cordova"];c.inArray(b,a)&&(p.context=a)}}),q.engrave({initialize:function(a,c){return q.initialized?void 0:(b.isPlainObject(a)||(a={}),b.isPlainObject(c)||(c={}),q.defaultView=a.defaultView,q.context=a.context,n.config=c,q.engrave({ViewModel:new k,App:(new l).become("App"),uiMessages:(new v).become("uiMessages"),uiStyles:(new l).become("uiStyles")}),q.App.set({loadingProgress:0,name:a.appName}),q.hook("App.loadingProgress",function(a){var b=q.get("App.loadingProgress")||0;return a.loadingProgress=b+a.loadingProgress,a}),p.modules.Debug&&(n.config.Debug={"protected":p}),q.Template.compile(),p.modules.StartupUtilities._initialize().then(function(){return p.modules.AppLoading._initialize()}).then(function(){return p.modules.OctaneRouter._initialize()}).then(function(){return p.modules.OctaneModals._initialize()}).then(function(){return r.run()}).then(function(){var a=b.map(p.modules,n.load);return Promise.all(a)}).then(function(){return r.run()}).then(function(){q.engrave({initialized:!0}),q.fire("octane:ready")}).catch(function(a){u.push(a)}))}}),window.octane=window.$o=q}($,_,__),octane.module("StartupUtilities").extend({initialize:function(){for(var a,b=({fastclickJS:function(){"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)
},!1)},historyJS:function(){try{!function(a){History.Adapter.bind(a,"statechange",function(){History.getState()})}(window)}catch(a){}}}),c=Object.keys(b),d=c.length;d--;)a=c[d],octane.fire("loading:utility",{detail:a}),_.isFunction(b[a])&&b[a].call()}}),octane.module("DefaultFilters").extend({initialize:function(){octane.filter("round",function(a,b){a=parseFloat(a);var c=Math.pow(10,b);return Math.round(a*c)/c}),octane.filter("roundDown",function(a){return a=parseFloat(a),Math.floor(a)}),octane.filter("titleize",function(a){return __.titleize(a)})}}),octane.module("AppLoading").extend({initialize:function(a){_.isPlainObject(a)||(a={}),octane.Model.create({message:"Loading...",progress:"0",percent:"0%",screenReader:"Loading"}).become("appLoading"),octane.hook("appLoading.progress",function(a){a.progress=a.progress<=100?a.progress:100,a.percent=a.progress.toString()+"%",a.screenReader=a.percent+" Loaded"}).hook("appLoading.message",function(a){a.message=_.isString(a.message)?a.message:"Loading..."}).handle("loaded:module",function(a){octane.set({"appLoading.message":"Loading module "+__.titleize(a.detail.moduleID),"appLoading.progress":octane.get("App.loadingProgress")})}).handle("loading:utility",function(a){octane.set({"appLoading.message":"Initializting startup utility "+titleize(a.detail)})}).handle("octane:ready",this.controllers.LoadingController.removeLoadingScreen)}}).controller("LoadingController",{removeLoadingScreen:function(){var a=octane.loadingContainer,b=octane.defaultView||octane.Router.getUrlView()||"home";octane.appContainer.classList.remove("hidden"),setTimeout(function(){octane.route(b).then(function(){return $.Velocity(a,"fadeOut",{duration:500})}).then(function(){document.body.removeChild(a)})},500)}}),octane.module("OctaneModals",["ViewController","UiOverlay"]).extend({initialize:function(){var a={},b=this.imports,c=b.ViewController.Factory,d=(b.ViewController.animations,b.UiOverlay),e=e||$.Velocity,f=(octane.modalContainer,[]),g=!1,h=!1,i=c.extend({initialize:function(b){b||octane.error("Must pass an HTML element to OctaneModal"),this.configure(b),this.adjustSize();var c=this.id;this.name=_.capitalize(_.camelCase(this.title))+"ModalController",a[c]=this},constructor:function(){return octane.Controller.apply(this,arguments)},call:function(){var a,b=octane.Router.isLocked;h?f.push(this.id):(octane.Router.lock(),a=g?g&&!this.isCurrent?g._exit().bind(this).then(this._load):Promise.resolve():d.on().bind(this).then(this._load),a.then(function(){!b&&octane.Router.unlock()}))},dismiss:function(){var a=octane.Router.isLocked;this.isCurrent&&(octane.Router.lock(),this._exit().then(function(){!a&&octane.Router.unlock(),g=!1}).then(d.off))},adjustSize:function(){var a=document.body.getBoundingClientRect(),b=a.top-a.bottom+"px",c=a.right-a.left+"px";_.extend(this.elem.style,{minHeight:b,width:c,minWidth:c,maxWidth:c})},destroy:function(){this._destroy(),delete a[this.name]},_load:function(){return this.adjustSize(),this._runBeforeLoad().bind(this).then(function(){this.elem.classList.add("modal-active"),e(this.elem,"scroll",{duration:300})}).then(function(){return this._runOnload()}).then(function(){g=this}).catch(function(a){octane.log(a)})},_exit:function(){return this.elem.classList.remove("modal-active"),this._runOnExit().catch(function(a){octane.log(a)})}},{create:function(a){return new i(a)},destroy:function(a){var b=i.get(a);b&&b.destroy()},get:function(b){return a[b]},call:function(b){var c=a[b];c&&c.call()},dismiss:function(){g&&g.dismiss()}});octane.defineGetter.apply(i.prototype,["isCurrent",function(){return this===g}]),octane.defineGetter.apply(i,["current",function(){return g}]),octane.defineGetter.apply(i,["isLocked",function(){return h}]),octane.compiler("o-modal",function(a){i.create(a)}).compiler("[o-modal]",function(a){a.addEventListener("click",function(){var b=a.getAttribute("o-modal");i.call(b)})}).compiler(".o-modal-dismiss",function(a){a.addEventListener("click",function(a){return a.stopPropagation,a.stopImmediatePropagation,i.dismiss(),!1})}).handle("routing:begin",function(){h=!0,octane.Modal.dismiss()}).handle("routing:complete",function(){h=!1,octane.Modal.call(f.pop())}).handle("load resize orientationchange",function(){g&&g.adjustSize()}).engrave({Modal:i})}}),octane.module("OctaneRouter",["OctaneViews"]).extend({initialize:function(){function a(a,b,c){return octane.fire("view:loading"),a._load().then(function(){if(octane.fire("view:loaded"),!b&&e({view:a.id}),d=a,octane.set({"App.viewID":a.id,"App.viewTitle":a.title}),c&&c._exit(),f=null,h){var g=h;return o(g.view,g.silent).then(function(){g.resolver(),h=null})}octane.fire("routing:complete")})}function b(a){for(var b=i[a]||[],c=0,d=b.length,e=function(a){return a.predicate()?!0:(_.isFunction(a.onfail)&&a.onfail(),!1)};d>c;c++)if(!e(b[c]))return!1;return!0}function c(){var a=document.getElementsByTagName("html")[0],b=a&&a.classList.contains("history");if(b)return __.urlObject().searchObject.view||!1;var c,d=window.location.hash,e={};return function(){d=d.replace("#?",""),d=d.split("&");for(var a=0,b=d.length;b>a;a++)c=d[a].split("="),e[c[0]]=c[1]}(),e.view||!1}var d,e=function(a){_.isObject(a)||(a={});var b=__.urlObject().searchObject;_.extend(b,a);for(var c,e=[],f=Object.keys(b),g=f.length;g--;)c=f[g],e.push(c+"="+b[c]);e=e.join("&"),e="?"+e;var h=octane.Translator&&octane.Translator.getLang(),i=__.titleize(a.view)||d.title;History.pushState({lang:h},octane.get("App.name")+" | "+i,e),document.querySelector("head>title").innerHTML=octane.get("App.name")+" | "+i},f=null,g=!1,h=null,i={},j=function(){g=!0},k=function(){g=!1,h&&o(h.view).then(h.resolver).catch(function(a){octane.log(a)})},l=function(a,b){return _.isObject(b)||(b={}),_.isArray(i[a])||(i[a]=[]),_.isFunction(b.predicate)||(b.predicate=function(){return!0}),i[a].push(b),octane},m=function(a,b,c){var d=octane.View.get(a);return d&&d.beforeLoad(b,c),octane},n=function(a,b,c){var d=octane.View.get(a);return d&&d.onload(b,c),octane},o=function(c,e){return new Promise(function(i,j){var k=octane.View.get(c),l=k==d,m=octane.Modal.current;if(e||(e=k.silent||!1),l&&m)m.dismiss(),i();else if(!k||k&&l)i();else if(!l)if(f||g)h={view:c,silent:e,resolver:i};else{if(!b(c))return void j('Routing condition not fulfilled for route "'+c+'"');octane.fire("routing:begin"),f=c,d?d._queueExit().then(function(){return a(k,e,d)}).then(i).catch(octane.log):a(k,e).then(i).catch(octane.log)}})};!function(){var a=document.getElementsByTagName("html")[0],b=a&&a.classList.contains("history"),d=b?"popstate":"hashchange";octane.handle(d,function(){var a=c();a&&octane.route(a)})}(),octane.engrave({Router:{},route:function(a,b){return o(a,b).catch(function(a){octane.log(a)})},routeIf:l,beforeRoute:m,routeThen:n,onroute:n}),octane.engrave.apply(octane.Router,[{getUrlView:c,pushState:e,lock:j,unlock:k,before:m}]),octane.defineGetter.apply(octane.Router,["isLocked",function(){return g}]),octane.defineGetter.apply(octane.Router,["queue",function(){return h}]),octane.defineGetter.apply(octane.View,["current",function(){return d}]),octane.handle("translated resize orientationchange",function(){d&&d.setCanvasHeight()}).compiler("[o-route]",function(a){a.addEventListener("click",function(){a.dispatchEvent(__.customEvent("octane:route",{bubbles:!0}))},!1),octane.handle("octane:route",a,function(a,b){var c=b.getAttribute("o-route");octane.route(c)})}).compiler(".o-back",function(a){a.addEventListener("click",function(){a.dispatchEvent(__.customEvent("octane:routeback",{bubbles:!0}))},!1),octane.handle("octane:routeback",a,function(){History.go(-1)})})}}),octane.module("Translator").extend({initialize:function(a){function b(a){_.isObject(a)&&(k.rosettaStone=a);for(var b=document.querySelectorAll("[o-lang]"),d=0,e=b.length;e>d;d++)c(b[d]);k.dropdown.pill.html(k.lang.display+" "),octane.fire("translated")}function c(a){var b=a.getAttribute("o-lang"),c=h(b);a.firstChild&&3==a.firstChild.nodeType?a.firstChild.data=c:a.insertBefore(document.createTextNode(c),a.firstChild)}function d(a,b){var c=k.dropdown;switch(!0){case _.isString(b):c.wrapper=$(b);break;case __.is$(b):c.wrapper=b}c.outerUL.appendTo(c.wrapper),c.outerLI.append(c.pill).append(c.innerUL).appendTo(c.outerUL),a=_.isArray(a)?a:[];var d,e,f,g=a.length;for(d=0;g>d;d++)e=j(a[d]),e&&(f=$("<li></li>"),f.addClass(c.classKey).attr("data-"+c.dataKey,e.key).html(e.display).appendTo(c.innerUL));i()}function e(){var a=__.urlObject().searchObject;k.lang=j(a.lang)||k.defaultLang}function f(){return k.lang.key}function g(a){return j(a)?(k.lang=j(a),f()):void 0}function h(a){var b,c,d,e;return k.isPaginated?(b=_.isString(a)?a.split("-"):[],c=b[0],d=b[1],e=k.rosettaStone[c]&&k.rosettaStone[c][d]?k.rosettaStone[c][d]:null):e=k.rosettaStone[a]?k.rosettaStone[a]:null,e?e[k.lang.abbr]?e[k.lang.abbr]:e[k.defaultLang.abbr]:""}function i(){var a,c;$("li."+k.dropdown.classKey).on("click",function(){a=$(this),c=a.data(k.dropdown.dataKey),g(c),b(),k.dropdown.pill.trigger("click")}),k.dropdown.pill.on("click",function(){var a=$(this);a.hasClass("closed")?(a.removeClass("closed").addClass("open"),k.dropdown.innerUL.show()):a.hasClass("open")&&(a.removeClass("open").addClass("closed"),k.dropdown.innerUL.hide())})}function j(a){var b,c,d=k.languages.length;for(b=0;d>b;b++)if(c=k.languages[b],c.regexp&&c.regexp.test&&c.regexp.test(a))return c;return!1}var k={};a=a||{},k.rosettaStone=_.isObject(a.langData)?a.langData:{},k.isPaginated=_.isBoolean(a.paginated)?a.paginated:!1,k.langSupport=_.isArray(a.langSupport)?a.langSupport:["English"],k.dropdown={wrapper:$("o-control#translator"),outerUL:$('<ul class="nav nav-pills"></ul>'),outerLI:$('<li class="dropdown"></li>'),pill:$('<a id="selected-language" class="dropdown-toggle closed" data-toggle="dropdown"></a>'),caret:$('<span class="caret"></span>'),innerUL:$('<ul class="dropdown-menu" role="menu"></ul>'),classKey:"language-selector",dataKey:"language-selected"},k.languages=[{key:"English",display:"English",abbr:"en",regexp:/^_?(english|eng|en)$/i},{key:"Russian",display:"Русский",abbr:"ru",regexp:/^_?(russian|rus|ru|Русский)$/i},{key:"Spanish",display:"Español",abbr:"es",regexp:/^_?(spanish|espanol|esp|es|español)$/i},{key:"French",display:"Françias",abbr:"fr",regexp:/^_?(french|francias|françias|fra|fr)$/i},{key:"German",display:"Deutsch",abbr:"de",regexp:/^_?(german|deutsch|ger|de)$/i},{key:"Chinese",display:"简体中文",abbr:"zh",regexp:/^_?(chinese|zh|简体中文)$/i},{key:"Portugese",display:"Portugese",abbr:"pt",regexp:/^_?(portugese|port|pt)$/i},{key:"Japanese",display:"日本語",abbr:"ja",regexp:/^_?(japanese|jap|ja|日本語|nihongo)$/i}],k.defaultLang=j(a.defaultLang)||k.languages[0],octane.Translator={renderTranslator:function(a,b){return d(a,b)},translate:function(a){return b(a)},translateElement:function(a){c(a)},getLang:function(){return f()},setLang:function(a){return g(a)}},function(){octane.handle("view:routed",octane.Translator.translate),e(),d(k.langSupport),b()}()}}),octane.module("ViewController").extend({initialize:function(a){var b=octane.Factory.extend({configure:function(b){_.extend(this,{instanced:!0,id:b.id,title:b.getAttribute("title")||_.startCase(b.id),elem:b,$elem:$(b),_guid:octane.GUID(),beforeLoadTasks:[],onloadTasks:[],onExitTasks:[]});var c,d=!1,e=["view-left","view-right","view-bottom","view-top","view-fader"];for(_.isArray(a.extraViewClasses)&&e.concat(a.extraViewClasses),c=e.length;c--;)if(this.elem.classList.contains(e[c])){d=!0;break}!d&&this.elem.classList.add("view-left")},setCanvasHeight:function(){var a=window.document.body.offsetHeight;this.elem.style.height=octane.viewContainer.style.height=a+"px"},beforeLoad:function(a,b){try{this.beforeLoadTasks.push([a,b])}catch(c){octane.log('cannot push "beforeLoad" promise to view '+this.id+", reason: "+c.message)}},onload:function(a,b){try{this.onloadTasks.push([a,b])}catch(c){octane.log('cannot push "onload" callback to view '+this.id+", reason: "+c.message)}},onExit:function(a,b){try{this.onExitTasks.push([a,b])}catch(c){octane.log('cannot push "onExit" callback to view '+this.id+", reason: "+c.message)}},_load:function(){return this.setCanvasHeight(),this._runBeforeLoad().bind(this).finally(function(){return this.elem.classList.add("view-active"),$.Velocity(this.elem,"scroll",{duration:100}),Promise.delay(405)}).then(this.setCanvasHeight).then(this._runOnload)},_exit:function(){return this.elem.classList.remove("view-dismissed"),this._runOnExit().delay(805)},_queueExit:function(){return this.elem.classList.add("view-dismissed"),this.elem.classList.remove("view-active"),Promise.delay(405)},_runBeforeLoad:function(){var a=this.beforeLoadTasks,b=_.map(a,this._execute);return Promise.settle(b)},_runOnload:function(){var a=this.onloadTasks,b=_.map(a,this._execute);return Promise.all(b)},_runOnExit:function(){var a=this.onExitTasks,b=_.map(a,this._execute);return Promise.all(b)},_execute:function(a){var b=a[0],c=_.isArray(a[1])?a[1]:[a[1]];return b.apply(this,c)}});this.export({Factory:b,animations:a.viewAnimations||"css"})}}),octane.module("UiOverlay").extend({initialize:function(){function a(a){var b,c,d,e="filter:blur(2px)";return void 0===a&&(a=!0),b=document.createElement("div"),b.style.cssText=a?"-webkit-"+e:e,c=0!==b.style.length,d=void 0===document.documentMode||document.documentMode>9,c&&d}var b,c,d,e,f=octane.bgContainer,g=octane.appContainer,h=(octane.viewContainer,octane.modalContainer),i=i||$.Velocity,j=octane.viewAnimationMethod||"css";e=octane.controller("ModalContainerController",{activate:{css:function(){return new Promise(function(a){h.classList.add("active"),a()})},js:function(){return new Promise(function(a){i(h,"fadeIn",{duration:400}).then(function(){return h.classList.add("active"),a()})})}},deactivate:{css:function(){return new Promise(function(a){setTimeout(function(){h.classList.remove("active"),a()},150)})},js:function(){return new Promise(function(a){i(h,"fadeOut",{duration:500}).then(function(){return h.classList.remove("active"),a()})})}}}),d=octane.controller("AppContainerController",{hide:{css:function(){return new Promise(function(a){g.classList.add("hidden"),setTimeout(a,305)})},js:function(){return new Promise(function(a){i(g,"fadeOut",{duration:300}).then(function(){return g.classList.add("hidden"),a()})})}},reveal:{css:function(){return new Promise(function(a){g.classList.remove("hidden"),setTimeout(a,305)})},js:function(){return new Promise(function(a){i(g,"fadeIn",{duration:300}).then(function(){return g.classList.remove("hidden"),a()})})}}}),c=octane.controller("BackgroundController",{activate:{css:function(){return new Promise(function(a){f.classList.add("active"),setTimeout(a,305)})},js:function(){return new Promise(function(a){i(f,"fadeIn",{duration:300}).then(function(){f.classList.add("active"),a()})})}},deactivate:{css:function(){return new Promise(function(a){f.classList.remove("active"),setTimeout(a,305)})},js:function(){return new Promise(function(a){i(f,"fadeOut",{duration:300}).then(function(){f.classList.remove("active"),a()})})}},removeImage:function(){return f.firstChild&&f.removeChild(f.firstChild),Promise.resolve()},getImage:function(){return new Promise(function(a){html2canvas(g,{onrendered:function(b){f.firstChild&&f.removeChild(f.firstChild),f.appendChild(b),a(b)}})})}}),b=octane.controller("OverlayController",{on:function(){return a?c.activate[j]().then(e.activate[j]).then(d.hide[j]):e.activate[j]()},off:function(){return a?e.deactivate[j]().then(d.reveal[j]).then(c.deactivate[j]):e.deactivte[j]()}}),a&&octane.handle("routing:complete",function(){c.getImage()}),this.export({on:b.on,off:b.off})}}),octane.module("OctaneViews",["ViewController"]).extend({initialize:function(){var a={},b=this.imports.ViewController.Factory,c=b.extend({initialize:function(b){b||octane.error("Must pass an HTML element to OctaneView"),this.configure(b),this.view=this.elem,this.name=_.capitalize(_.camelCase(this.title))+"ViewController",a[this.id]=this},constructor:function(){return octane.Controller.apply(this,arguments)},destroy:function(){this._destroy(),delete a[this.name]}},{create:function(a){return new c(a)},destroy:function(a){var b=this.get(a);b&&b.destroy()},get:function(b){return a[b]}});octane.compiler("o-view",c.create.bind(c)),octane.engrave({View:c})}});