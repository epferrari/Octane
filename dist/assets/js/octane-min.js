/* octane -  - 2015-01-04*/!function(a,b,c){var d={isObject:function(a,b){return b?"object"==typeof a&&null!==a:"object"==typeof a&&null!==a&&!(a instanceof Array)},isArray:function(a){return"object"==typeof a&&a instanceof Array&&a.length>=0},isFalsey:function(a){var b="case_"+a,c={case_false:function(){return!0},case_0:function(){return!0},case_null:function(){return!0},case_undefined:function(){return!0},case_:function(){return!0}};return b=b.trim(),c[b]?c[b]():!1},isUndefined:function(a){return"undefined"==typeof a},isNull:function(a){return null===a},isBlank:function(a){var b="case_"+a,c={case_undefined:function(){return!0},case_null:function(){return!0},case_:function(){return!0}};return b=b.trim(),c[b]?c[b]():!1},is$:function(a){return a instanceof c},createEvent:function(a){var b;try{b=new Event(a)}catch(c){b=document.createEvent("event"),b.initEvent(a,!0,!1)}return b},customEvent:function(a,c){var d;if(b.CustomEvent)try{c=c||{bubbles:!1,cancelable:!1,detail:{}},d=new CustomEvent(a,c)}catch(e){d=document.createEvent("CustomEvent"),d.initCustomEvent(a,c.bubbles||!1,c.cancelable||!1,c.detail||{})}else d=document.createEvent("CustomEvent"),d.initCustomEvent(a,c.bubbles||!1,c.cancelable||!1,c.detail||{});return d},Switch:function(a){function b(a,b,c){return c?void("undefined"==d.typeOf(f[a])&&(f[a]=[b])):(f[a]=_.isArray(f[a])?f[a]:[],_.isFunction(b)&&f[a].push(b),e)}function c(a,b){function c(a,b){var c=a.length;if(1==c)return _.isFunction(a[0])&&a[0].apply(null,b);for(var e=0;c>e;e++)d(a[e],b)}function d(a,b){setTimeout(function(){_.isFunction(a)&&a.apply(null,b)},0)}f["default"]||(f["default"]=[function(){return!1}]);return b=_.isArray(b)?b:_.isString(b)?b.split(","):[],f[a]?c(f[a],b):f["default"][0](b)}var e=this,f={};if(_.isObject(a))for(var g in a)({}).hasOwnProperty.call(a,g)&&b(g,a[g]);this.addCase=function(a,c){return b(a,c)},this.run=function(a,b){return c(a,b)},this.getCases=function(){return f}},typeOf:function(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},location:function(){var a,c,e=document.createElement("a"),f={};e.href=b.location,a=e.search.replace(/^\?/,"").split("&");for(var g=0,h=a.length;h>g;g++)if(c=a[g].split("="),!d.isBlank(c)){var i=c[0],j=c[1];f[i]=j}return{protocol:e.protocol,host:e.host,hostname:e.hostname,port:e.port,pathname:e.pathname,searchString:e.search,searchObject:f,hash:e.hash}},titleize:function(a){return"string"==d.typeOf(a)?a.replace(/\-+|[_]+/," ").replace(/^.|\s+?[a-z]/g,function(a){return a.toUpperCase()}):void 0},camelize:function(a){return"string"==d.typeOf(a)?a.replace(/\W+?[a-z]|\_+?[a-z]/g,function(a){return a.toUpperCase()}).replace(/\W+|\_+/g,""):void 0},dashify:function(a){return"string"==d.typeOf(a)?a.replace(/\s+|[_]+/g,"-").replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()}).replace(/-{2}/g,"-"):void 0},inArray:function(a,b){return-1!==a.indexOf(b)}};!String.prototype.__titleize&&Object.defineProperty(String.prototype,"__titleize",{value:function(){return this.replace(/\-+|[_]+/," ").replace(/^.|\s+?[a-z]/g,function(a){return a.toUpperCase()})},configurable:!1,writable:!1,enumerable:!1}),!String.prototype.__camelize&&Object.defineProperty(String.prototype,"__camelize",{value:function(){return this.replace(/\W+?[a-z]|\_+?[a-z]/g,function(a){return a.toUpperCase()}).replace(/\W+|\_+/g,"")},configurable:!1,writable:!1,enumerable:!1}),!String.prototype.__dashify&&Object.defineProperty(String.prototype,"__dashify",{value:function(){return this.replace(/\s+|[_]+/g,"-").replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()}).replace(/-{2}/g,"-")},configurable:!1,writable:!1,enumerable:!1}),!Function.prototype.__construct&&Object.defineProperty(Function.prototype,"__construct",{value:function(a){var b=this.prototype,c=Object.create(b);return this.apply(c,a),c},configurable:!1,writable:!1,enumerable:!1}),!Array.prototype.__contains&&Object.defineProperty(Array.prototype,"__contains",{value:function(a){return-1!==this.indexOf(a)},configurable:!1,writable:!1,enumerable:!1}),!Array.prototype.__isEmpty&&Object.defineProperty(Array.prototype,"__isEmpty",{value:function(){return 0===this.length},configurable:!1,writable:!1,enumerable:!1}),!Object.prototype.__isEmpty&&Object.defineProperty(Object.prototype,"__isEmpty",{value:function(){var a;for(a in this)if({}.hasOwnProperty.call(this,a))return!1;return!0},configurable:!1,writable:!1,enumerable:!1}),b[a]=d}("__",window,jQuery),function(a,b,c){"use strict";function d(a){this.name=b.isString(a)&&a}function e(){}function f(a,c,d){a=b.isArray(a)?a:[];for(var e=0,f=a.length;f>e;e++)if(!a[e][0])return r.log("Context: "+d+". A "+c+" failed; "+a[e][1]),!1;return!0}function g(a,c){a=b.isString(a)?a:"",c=b.isObject(c)?c:{};var d,e,f=/\{\{([^{^}]+)\}\}/g,g=a.match(f);if(b.isArray(g))for(var h=0,i=g.length;i>h;h++)d=g[h].replace(/[{}]+/g,""),e=new RegExp("(\\{\\{"+d+"\\}\\})","g"),a=a.replace(e,c[d]);return a}function h(a,c){if(b.isObject(c)){var d=b.isObject(c)?c:{};this.name=a,this.checkout=function(){return d},this.contrib=function(a,b){d[a]||(d[a]=b)},this.resolve(d)}else this.reject("invalid library data, not an object")}function i(a,c){c=b.isObject(c)?c:{},c.context=c.context||"Application";var e=[[b.isString(a),"Model name must be a string."]],g=f(e,"Model",c.context);if(!g)return{instanced:!1};var h={},i=this;this.define({instanced:!0,name:a,context:c.context,state:{}});var k=new j(i);this.define({access:function(a){return h[a]},reScope:function(){k.parse()}}),function(b){r.models[a]=b,d.prototype.extend.call(h,c.db),b.set(c.defaults)}(this)}function j(a){var b=this;this.define({instanced:!0,model:a,watcher:new c.Switch,scope:{}}),function(a){a.watcher.addCase("input",function(b){a.uptake(b.srcElement)}).addCase("select",function(b){a.uptake(b.srcElement)}).addCase("click",function(b){a.uptake(b.srcElement)}).addCase(a.model.name+":statechange",function(){a.refresh()}),q.handle("input click "+a.model.name+":statechange",a),a.parse(),a.refresh()}(b)}function k(a,b){b=b||"Application";var d=r.models[a]||{},e=[[d instanceof i,"defined model is not an instance of octane.Model"],[d.instanced,"model "+a+" passed as argument was not initialized"]],g=f(e,"Controller",b);if(!g)return{instanced:!1};var h=this;this.define({instanced:!0,model:d,context:b,tasks:new c.Switch,filters:{},parsers:{},hooks:{}}),function(){r.controllers[a]=h,q.handle(h.model.name+":statechange",h)}()}function l(a){r.bootlog.push(a),q.model("bootlog").set({bootlog:r.bootlog,status:a})}function m(a){this.extend(a)}function n(a,b,d){d="function"==c.typeOf(arguments[2])?arguments[2]:arguments[1],r.modules[a]=new m({name:a,constructor:d,dependencies:"object"==c.typeOf(arguments[1])?arguments[1]:{},loaded:!1})}function o(a){a=a||{};var c,d,e=Object.keys(r.modules),f=[];return r.modules.router._load().then(function(){for(var g=0,h=e.length;h>g;g++)d=e[g],c=r.modules[d],c.loaded||!function(c){c.cfg=b.isArray(a[d])?a[d]:[],l(c.name+": not loaded, loading..."),f.push(c._load())}(c);return Promise.all(f)}).catch(function(a){console.log(a)})}function p(a){a=a||{};for(var c,d=q.library("startup-utilities")||{},e=Object.keys(d),f=0,g=e.length;g>f;f++)c=e[f],q.fire("loading:utility",{detail:c}),b.isFunction(d[c])&&d[c].call();r.modules.debug&&(a.debug=[r]),o(a).then(function(){q.name=a.name||q.name,setTimeout(function(){q.dom.container().setAttribute("style","visibility:visible;")},1e3),q.fire("octane:ready")})}if(!window.__)return!1;if(window.octane)return!1;Object.defineProperty(d.prototype,"extend",{value:function(a,c){c=b.isBoolean(c)?c:!0;var d,e;if(b.isObject(a)){d=Object.keys(a);for(var f=0,g=d.length;g>f;f++)e=d[f],c?this[e]=a[e]:this[e]||(this[e]=a[e])}return this},writable:!1,configuarable:!1}),Object.defineProperty(d.prototype,"define",{value:function(a,c,d){switch(b.isBoolean(arguments[0])?(a=arguments[0],c=arguments[1],d=arguments[2]):(c=arguments[0],d=arguments[1],a=!1),!0){case b.isObject(c):for(var e,f=Object.keys(c),g=0,h=f.length;h>g;g++)e=f[g],Object.defineProperty(this,e,{value:c[e],configurable:!1,writable:a,enumerable:!0});break;case b.isString(c):Object.defineProperty(this,c,{value:d,configurable:!1,writable:a,enumerable:!0})}return this},writable:!1,configuarable:!1}),e.prototype=new d("Simple Promise"),e.prototype.extend({state:"pending",result:null,error:null}),e.prototype.define({constructor:e,_isResolved:function(){return"resolved"==this.state},_isRejected:function(){return"rejected"==this.state},_isPending:function(){return"pending"==this.state},resolveCallbacks:[],rejectCallbacks:[],then:function(a,c){return a=b.isFunction(a)?a:function(){},c=b.isFunction(c)?c:function(){},this.resolveCallbacks.push(a),this.rejectCallbacks.push(c),"resolved"==this.state?a(this.result):"rejected"==this.state?c(this.error):void 0},resolve:function(a){var b=this.resolveCallbacks;this.state="resolved",this.result=a;for(var c=0,d=b.length;d>c;c++)setTimeout(function(){b[c].call&&b[c].call(null,a)},0)},reject:function(a){var b=this.rejectCallbacks;this.state="rejected",this.error=a;for(var c=0,d=b.length;d>c;c++)setTimeout(function(){b[c].call&&b[c].call(null,a)},0)}});var q=new d("octane"),r=new d("octane protected");r.define({modules:{},models:{},views:{},controllers:{},eventRegister:{}}),q.define({GUID:function(){var a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1).toUpperCase()};return"octane"+a()+"-"+a()+"-"+a()+a()}}),r.extend({logfile:[],log:function(a){r.logfile.push(a)},getLogfile:function(){return r.logfile}}),q.define({handle:function(a,c){for(var d=a?a.split(" "):[],e=0,f=d.length;f>e;e++)window.addEventListener(d[e],c,!1),b.isArray(r.eventRegister[d[e]])||(r.eventRegister[d[e]]=[]),r.eventRegister[d[e]].push(c)},fire:function(a,d){if(b.isString(a)){var e=d?c.customEvent(a,d):c.createEvent(a);window.dispatchEvent(e)}}}),r.templates={},q.define({addTemplate:function(a,c){b.isString(a)&&b.isString(c)&&(r.templates[a]?r.log("Could not create template "+a+". Already exists"):r.templates[a]=c)},template:function(a,b){var c=document.createElement("o-template");return c.innerHTML=g(r.templates[a],b),c}}),r.filters=new c.Switch,q.define({addFilter:function(a,c,d){c=c||/.*/,d=d||/.*/;var e=function(a){switch(!0){case c.test(a):return{data:a,status:"valid"};case b.isEmpty(a)||b.isUndefined(a):return{data:null,status:"undefined"};case d.test(a):return{data:null,status:"invalid"};default:return{data:a,status:"default"}}};r.filters.addCase(a,e,!0)}}),q.addFilter("number",/^[-\d]+$/),q.addFilter("email",/^[-0-9a-zA-Z]+[-0-9a-zA-Z.+_]+@(?:[A-Za-z0-9-]+\.)+[a-zA-Z]{2,4}$/),q.addFilter("tel",/^[-0-9\.]{7,12}$/),r.libraries={},h.prototype=new e,q.define({addLibrary:function(a,c){r.libraries[a]=b.isObject(c)?new h(a,c):{}},library:function(a){return q.hasLibrary(a).then(function(a){return a})},hasLibrary:function(a){var b=r.libraries[a];return b instanceof h?b:Promise.reject("Error: Library "+a+" does not exist")}}),i.prototype=new d,i.prototype.constructor=i,i.prototype.define({set:function(a){function c(a,c,d){return a[c]=d==m-1?l:b.isObject(a[c])?a[c]:{}}if(b.isObject(a)&&b.isObject(this.state)){for(var d=[],e=this.state,f=Object.keys(a),g=0,h=f.length;h>g;g++){var i,j=f[g],k=j.split("."),l=a[j],m=k.length;try{k.reduce(c,e),i=!0}catch(n){i=!1,r.log('Unable to set model data "'+j+'". Error: '+n)}i&&d.push(j)}var n=this.name+":statechange";q.fire(n,{detail:d})}},get:function(a){var b,c=this;if(a){var d=a.split(".");try{b=d.reduce(function(a,b){return a[b]},c.state)}catch(e){b="",r.log('Unable to get model data "'+a+'". Error: '+e)}return b}return this.state},process:function(a){r.controllers[this.name]&&r.controllers[this.name].doFilter(a)}}),q.define({model:function(a,c){return r.models[a]?r.models[a]:(c=b.isObject(c)?c:{},new i(a,c))}}),j.prototype=new d,j.prototype.define({parse:function(){for(var a=document.querySelectorAll('[o-bind^="'+this.model.name+'."]'),d=document.querySelectorAll('[o-update*="'+this.model.name+'."]'),e=[],f=0,g=a.length;g>f;f++)e.push(a[f]);for(var h=0,i=d.length;i>h;h++)c.inArray(e,d[h])||e.push(d[h]);for(var j=0,k=e.length;k>j;j++){var l=e[j],m=l.getAttribute("o-bind"),n=l.getAttribute("o-update"),o={};n&&(n.length>0&&0!==n.indexOf("{")?o[n]="html":o=b.invert(JSON.parse(l.getAttribute("o-update")))||{}),l._guid||(l._guid=q.GUID(),l._bind=m,l._update=o,l._filters=JSON.parse(l.getAttribute("o-filters"))),m&&(b.isArray(this.scope[m])||(this.scope[m]=[]),c.inArray(this.scope[m],l)||this.scope[m].push(l));for(var p,r=Object.keys(o),s=0,t=r.length;t>s;s++)p=r[s],b.isArray(this.scope[p])||(this.scope[p]=[]),c.inArray(this.scope[p],l)||this.scope[p].push(l)}},refresh:function(){function a(a,b,d){var e=new c.Switch({html:function(){a.innerHTML=d},text:function(){a.textContent=d},"default":function(){a.setAttribute(b,d)}});e.run(b)}for(var b,d=Object.keys(this.scope),e=0,f=d.length;f>e;e++){b=d[e];for(var g=0,h=this.scope[b].length;h>g;g++){var i,j,k=this.scope[b][g],l=k._bind?k._bind.split(".").slice(1).join("."):"",m=k._update,n=Object.keys(m);k.value=this.model.get(l);for(var o=0,p=n.length;p>o;o++)i=n[o],j=i.split(".").slice(1).join("."),a(k,m[i],this.model.get(j))}}},uptake:function(a){var b=a._bind,c=b?b.split(".").slice(1).join("."):"",d={};this.scope[b]&&a.value!=this.model.get(c)&&(d[c]=a.value,r.controllers[this.model.name]&&r.controllers[this.model.name].doFilter(d))},handleEvent:function(a){this.watcher.run(a.type,[a])}}),k.prototype=new d,k.prototype.constructor=k,k.prototype.define({filter:function(a,b){return this.filters[a]=b,this},parser:function(a,c){var d=c.toString().split("{")[0],e=/\(([^)]+)\)/,f=e.exec(d)[1],g=f.split(","),h=this;return b.isFunction(c)&&b.isUndefined(this.parsers[a])&&(this.parsers[a]=2==g.length?function(a){return new Promise(function(b,d){var e={resolve:b,reject:d};c.bind(h)(a,e)})}:function(a){return c.bind(h,a)()}),this},hook:function(a,b){return this.hooks[a]=new c.Switch(b),this},task:function(a,d){function e(a){a=a.trim(),f.tasks.addCase(a,function(){var b=f.model.get(a);d.bind(f)(a,b)})}var f=this;if(b.isFunction(d)){"string"==c.typeOf(a)&&(a=a.split(","));for(var g=0,h=a.length;h>g;g++)e(a[g])}return this},fetch:function(a){return this.model.access(a)},doFilter:function(a){function c(a){a=b.isObject(a)?a:{};for(var c,f,g=Object.keys(a),h=0,i=g.length;i>h;h++)c=g[h],f=e.filters[c],a=e.filters[c]?d(f,c,a):a;return a}function d(a,b,c){var d=r.filters.run(a,[c[b]]);return c[b]=d.data,e.hooks[b]?e.hooks[b].run(d.status,[c]):c}var e=this;this.applyParsers(c(a))},applyParsers:function(a){var c,d=this;if(b.isObject(a))for(var e,f=Object.keys(a),g=0,h=f.length;h>g;g++)e=f[g],c=d.parsers[e]&&d.parsers[e](a),b.isObject(c)&&b.isFunction(c.then)?c.then(d.model.set):d.model.set(a)},handleEvent:function(a){function b(a){for(var b=0,c=a.length;c>b;b++)d(a[b])}function d(a){setTimeout(function(){e.tasks.run(a)},0)}var e=this,f=new c.Switch;f.addCase(e.model.name+":statechange",b),f.run(a.type,[a.detail])}}),q.define({controller:function(a){return r.controllers[a]?r.controllers[a]:new k(a,"Application")}}),r.bootlog=[],m.prototype=new d,m.prototype.define({checkDependencies:function(){var a=this.dependencies||{},c=a.modules||[],d=a.libraries||[],e=[],f=[this.name+": checking dependencies...",this.name+": no dependencies, preparing to initialize..."];if(l(f[0]),b.isString(c)&&(c=c.split(",")),b.isString(d)&&(d=d.split(",")),0===c.length&&0===d.length)return l(f[1]),Promise.resolve();for(var g=0,h=c.length;h>g;g++)e.push(this.checkModuleDependency(c[g]));for(var i=0,j=d.length;j>i;i++)e.push(this.checkLibDependency(d[i]));return Promise.all(e)},checkModuleDependency:function(a){a=a?a.trim():"";var b=this,c=r.modules[a],d=[this.name+": no dependencies, preparing to initialize...",this.name+': Could not load module, missing module dependency "'+a+'"',this.name+': dependency "'+a+'" loaded and initialized, continuing...',this.name+': dependency "'+a+'" not yet loaded, loading now...'];return a&&0!==a.length?c&&c instanceof m?c&&c.loaded?(l(d[2]),Promise.resolve()):c.loaded?void 0:(l(d[3]),c._load().then(function(){return b.checkDependencies()}).catch(function(a){l(a),Promise.reject(a)})):(l(d[1]),Promise.reject(d[1])):(l(d[0]),Promise.resolve())},checkLibDependency:function(a){var b=[this.name+': library dependency "'+a+'" found, continuing...',this.name+': could not load module, missing library "'+a+'"'];return q.hasLibrary(a).then(function(){return l(b[0]),Promise.resolve()}).catch(function(a){return l(a),Promise.reject(b[1])})},_load:function(){var a=this;return this.loaded?void Promise.resolve(a):this.checkDependencies().then(function(){return a._initialize()}).catch(function(b){return l(b),a._abort()})},_abort:function(){return this.define({loaded:!1}),delete q[this.name],Promise.reject(this.name+": failed to initialize!")},_initialize:function(){var a=this,b=[this.name+": initializing...",this.name+": successfully initialized!",this.name+": already initialized, continuing..."];return this.loaded||(l(b[0]),this.constructor.prototype=new m,this.define({loaded:!0,name:this.name}).define(this.constructor.__construct(this.cfg)),Object.defineProperty(q,a.name,{value:a,writatble:!1,configurable:!1}),l(b[1]),q.goose("application",{loadingProgress:Math.ceil(100/Object.keys(r.modules).length)}),q.fire("loaded:module",{detail:{moduleID:this.name}})),Promise.resolve(this)},model:function(a,c){return r.models[a]?r.models[a]:(c=b.isObject(c)?c:{},c.context=this.name+" module",new i(a,c))},controller:function(a){return r.controllers[a]?r.controllers[a]:new k(a,this.name+" module")}}),q.define({module:function(a,b,c){return n(a,b,c)},hasModule:function(a){return r.modules[a]?r.modules[a].loaded:!1}}),q.define({goose:function(a,b){r.controllers[a]&&r.controllers[a].doFilter(b)},trip:function(a){var b=Math.random(),d=c.customEvent("input",{bubbles:!0,detail:b});a.dispatchEvent&&a.dispatchEvent(d)}}).define({appModel:new i("application"),$Controller:new k("application"),dom:{}}),q.define.call(q.dom,{container:function(){return document.getElementsByTagName("o-container")[0]||document.createElement("o-container")},canvas:function(){return document.getElementsByTagName("o-canvas")[0]||document.createElement("o-canvas")},views:function(){return document.getElementsByTagName("o-view")||[]}}),q.controller("application").parser("loadingProgress",function(a){var b=this.model.get("loadingProgress")||0;a.loadingProgress=b+a.loadingProgress}),q.define({initialize:function(a){return p(a)}}),window.octane=window.$o=q}($,_,__),octane.addLibrary("startup-utilities",{fastlickJS:function(){"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1)},historyJS:function(){!function(a){History.Adapter.bind(a,"statechange",function(){History.getState()})}(window)}}),octane.module("router",{modules:"octane-views"},function(){function a(a){a=_.isObject(a)?a:{};var b=__.location().searchObject;octane.extend.call(b,a);var c=[];for(var d in b)({}).hasOwnProperty.call(b,d)&&c.push(d+"="+b[d]);c=c.join("&"),c="?"+c;var e=octane.translator&&octane.translator.getLang(),f=__.titleize(a.view)||__.titleize(k);History.pushState({lang:e},octane.name+" | "+f,c)}function b(a,b){return new Promise(function(d){b=_.isBoolean(b)?b:!1;var e=octane.view(a);e&&e!=k?j?__.inArray(l,a)||l.push(a):(j=!0,k?k.exit().done(function(){c(e,b).done(function(a){octane.fire("routed:view"),d(a)})}):c(e,b).done(d)):d()})}function c(c,d){return new Promise(function(e){c.load().done(function(){!d&&a({view:c.id}),k=c,octane.goose("application",{currentView:c.id}),j=!1,e(),l.length>0&&b(l.pop())})})}function d(a,b){return octane.view(a)&&octane.view(a).addCallback(b),octane}function e(a){octane.view(a)&&octane.view(a).exit(),octane.goose("application",{currentView:""})}function f(){for(var a=document.querySelectorAll("[o-route]"),b=a.length;b--;)g(a[b])}function g(a,b){var b=a.getAttribute("o-route");a.addEventListener("click",function(){octane.route(b)})}function h(){var a=__.inArray(document.getElementsByTagName("html")[0].getAttribute("class").split(" "),"history");if(a)return __.location().searchObject.view||!1;var b,c=window.location.hash,d={};return function(){c=c.replace("#?",""),c=c.split("&");for(var a=0,e=c.length;e>a;a++)b=c[a].split("="),d[b[0]]=b[1]}(),d.view||!1}function i(){var a=__.inArray(document.getElementsByTagName("html")[0].getAttribute("class").split(" "),"history"),b=a?"popstate":"hashchange";f(),window.addEventListener(b,function(){var a=h();a&&octane.route(a).done(function(){})}),octane.handle("translated resize orientationchange",function(){k&&k.setCanvasHeight()})}var j,k,l=[];octane.define({parseView:function(){return h()},route:function(a,c){return b(a,c)},routeThen:function(a,b){return d(a,b)},exit:function(a){return e(a)},pushState:function(b){a(b)},currentView:function(){return k}}),octane.controller("application").parser("currentView",function(a){return a.currentViewTitle=__.titleize(a.currentView),a}),i()}),octane.addLibrary("view-animations",{applyLoading:function(){},removeLoading:function(){},loads:{slide:function(a){var b=this,c=b.$elem,d={duration:b.loadDuration,easing:b.loadEasing,complete:a},e=new __.Switch({left:function(){c.velocity({left:"0%"},d)},right:function(){c.velocity({right:"0%"},d)},top:function(){c.velocity({top:"0%"},d)},bottom:function(){c.velocity({bottom:"0%"},d)}});e.run(b.loadsFrom)},fade:function(a){var b=this,c=b.$elem;b.setPosition("onscreen").then(function(){c.velocity("fadeIn",{display:"block",easing:b.loadEasing,duration:b.loadDuration,complete:a})})}},exits:{slide:function(a){var b=this,c=b.$elem,d={duration:b.exitDuration,easing:b.exitEasing,complete:a},e=new __.Switch({left:function(){c.velocity({left:-(1.1*$(window).width()),right:2.2*$(window).width()},d)},right:function(){c.velocity({right:-(1.1*$(window).width()),left:2.2*$(window).width()},d)},top:function(){c.velocity({top:-(1.1*$(window).height()),bottom:2.2*$(window).height()},d)},bottom:function(){c.velocity({bottom:-(1.1*$(window).height()),top:2.2*$(window).height()},d)}});e.run(b.exitsTo)},fade:function(a){var b=this,c=b.$elem;c.velocity("fadeOut",{display:"none",easing:b.exitEasing,duration:b.exitDuration,complete:a})}}}),octane.module("translator",function(a){function b(a){_.isObject(a)&&(k.rosettaStone=a);for(var b=document.querySelectorAll("[o-lang]"),d=0,e=b.length;e>d;d++)c(b[d]);k.dropdown.pill.html(k.lang.display+" "),octane.fire("translated")}function c(a){var b=a.getAttribute("o-lang"),c=h(b);a.firstChild&&3==a.firstChild.nodeType?a.firstChild.data=c:a.insertBefore(document.createTextNode(c),a.firstChild)}function d(a,b){var c=k.dropdown;switch(!0){case _.isString(b):c.wrapper=$(b);break;case __.is$(b):c.wrapper=b}c.outerUL.appendTo(c.wrapper),c.outerLI.append(c.pill).append(c.innerUL).appendTo(c.outerUL),a=_.isArray(a)?a:[];var d,e,f,g=a.length;for(d=0;g>d;d++)e=j(a[d]),e&&(f=$("<li></li>"),f.addClass(c.classKey).attr("data-"+c.dataKey,e.key).html(e.display).appendTo(c.innerUL));i()}function e(){var a=__.location().searchObject;k.lang=j(a.lang)||k.defaultLang}function f(){return k.lang.key}function g(a){return j(a)?(k.lang=j(a),f()):void 0}function h(a){var b,c,d,e;return k.isPaginated?(b=_.isString(a)?a.split("-"):[],c=b[0],d=b[1],e=k.rosettaStone[c]&&k.rosettaStone[c][d]?k.rosettaStone[c][d]:null):e=k.rosettaStone[a]?k.rosettaStone[a]:null,e?e[k.lang.abbr]?e[k.lang.abbr]:e[k.defaultLang.abbr]:""}function i(){var a,c;$("li."+k.dropdown.classKey).on("click",function(){a=$(this),c=a.data(k.dropdown.dataKey),g(c),b(),k.dropdown.pill.trigger("click")}),k.dropdown.pill.on("click",function(){var a=$(this);a.hasClass("closed")?(a.removeClass("closed").addClass("open"),k.dropdown.innerUL.show()):a.hasClass("open")&&(a.removeClass("open").addClass("closed"),k.dropdown.innerUL.hide())})}function j(a){var b,c,d=k.languages.length;for(b=0;d>b;b++)if(c=k.languages[b],c.regexp&&c.regexp.test&&c.regexp.test(a))return c;return!1}var k={};a=a||{},k.rosettaStone=_.isObject(a.langData)?a.langData:{},k.isPaginated=_.isBoolean(a.paginated)?a.paginated:!1,k.langSupport=_.isArray(a.langSupport)?a.langSupport:["English"],k.dropdown={wrapper:$("o-control#translator"),outerUL:$('<ul class="nav nav-pills"></ul>'),outerLI:$('<li class="dropdown"></li>'),pill:$('<a id="selected-language" class="dropdown-toggle closed" data-toggle="dropdown"></a>'),caret:$('<span class="caret"></span>'),innerUL:$('<ul class="dropdown-menu" role="menu"></ul>'),classKey:"language-selector",dataKey:"language-selected"},k.languages=[{key:"English",display:"English",abbr:"en",regexp:/^_?(english|eng|en)$/i},{key:"Russian",display:"Русский",abbr:"ru",regexp:/^_?(russian|rus|ru|Русский)$/i},{key:"Spanish",display:"Español",abbr:"es",regexp:/^_?(spanish|espanol|esp|es|español)$/i},{key:"French",display:"Françias",abbr:"fr",regexp:/^_?(french|francias|françias|fra|fr)$/i},{key:"German",display:"Deutsch",abbr:"de",regexp:/^_?(german|deutsch|ger|de)$/i},{key:"Chinese",display:"简体中文",abbr:"zh",regexp:/^_?(chinese|zh|简体中文)$/i},{key:"Portugese",display:"Portugese",abbr:"pt",regexp:/^_?(portugese|port|pt)$/i},{key:"Japanese",display:"日本語",abbr:"ja",regexp:/^_?(japanese|jap|ja|日本語|nihongo)$/i}],k.defaultLang=j(a.defaultLang)||k.languages[0],this.define({renderTranslator:function(a,b){return d(a,b)},translate:function(a){return b(a)},translateElement:function(a){c(a)},getLang:function(){return f()},setLang:function(a){return g(a)}}),octane.handle("view:routed",b),e(),d(k.langSupport),b()}),octane.module("octane-views",{libraries:"view-animations"},function(a){function b(a,b){if(!_.isString(a))return{instanced:!1};b=_.isObject(b)?b:{};var c=["left","right","top","bottom","behind","invisible","onscreen"],d=_.isObject(b.loads),e=_.isObject(b.exits),f={loadsBy:d&&b.loads.by||"slide",loadsFrom:d&&__.inArray(c,b.loads.from)?b.loads.from:"left",loadEasing:d&&b.loads.ease||"swing",loadDuration:d&&_.isNumber(b.loads.dur)?b.loads.dur:500,exitsBy:e&&b.exits.by||"slide",exitsTo:e&&__.inArray(c,b.exits.to)?b.exits.to:"right",exitEasing:e&&b.exits.ease||"swing",exitDuration:e&&_.isNumber(b.exits.dur)?b.exits.dur:500};this.define(f),this.define({instanced:!0,id:a,elem:document.getElementById(a),$elem:$("o-view#"+a),_guid:octane.GUID(),doneLoading:[],addCallback:function(a){_.isFunction(a)&&this.doneLoading.push(a)}}),this.setPosition(this.loadsFrom)}function c(){for(var a=octane.dom.views(),c=0,d=a.length;d>c;c++)id=a[c].id,config=JSON.parse(a[c].getAttribute("o-config")),!f[id]&&(f[id]=new b(id,config));octane.define({view:function(a){return f[a]||!1}})}var d,e=octane.constructor,f={};try{d=a.animations.exits&&a.animations.loads?a.animations:octane.library("view-animations")}catch(g){d=octane.library("view-animations"),octane.hasModule("debug")&&octane.log("Could not load user-defined view animations. Error: "+g+". Using default")}b.prototype=new e("octane View"),b.prototype.define({constructor:b,handleEvent:function(a){switch(a.type){case"translated":this.setCanvasHeight();break;case"resize":this.setCanvasHeight();break;case"orientationchange":this.setCanvasHeight()}},load:function(){var a=this;return new Promise(function(b){$("body").velocity("scroll",{duration:350}),a.$elem.css({visibility:"visible",display:"block","z-index":999999999}),"fade"!==a.loadsBy&&a.$elem.css({opacity:1}),a.setCanvasHeight(),d.loads[a.loadsBy].bind(a,b)()}).then(function(){a.doCallbacks()})},exit:function(){var a=this;return new Promise(function(b){d.exits[a.exitsBy].bind(a,b)()}).then(function(){a.$elem.css({"z-index":-1,visibility:"hidden",display:"none",opacity:0}),a.setPosition(a.loadsFrom)})},setCanvasHeight:function(){var a=[];this.$elem.children().each(function(){a.push($(this).height())});var b=_.reduce(a,function(a,b){return a+b});document.querySelector("o-canvas").setAttribute("style","height:"+b+"px")},setPosition:function(a){var b=this;return new Promise(function(c){var d=b.$elem,e=new __.Switch({left:function(){d.css({left:-(1.1*$(window).width()),top:0})},right:function(){d.css({right:-(1.1*$(window).width()),top:0})},top:function(){d.css({top:-(1.1*$(window).height()),left:0,right:0})},bottom:function(){d.css({bottom:-(1.1*$(window).height()),left:0,right:0})},onscreen:function(){d.css({left:0,right:0,top:0})},"default":function(){d.css({left:-(1.1*$(window).width()),top:0})}});e.run(a),c()})},doCallbacks:function(){for(var a=this,b=this.doneLoading,c=0,d=b.length;d>c;c++)_.isFunction(b[c])&&b[c].bind(a)()}}),c()});